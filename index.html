<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bancas • Depósito PIX</title>

  <!-- 1) Chave pública: deve ser IGUAL à APP_PUBLIC_KEY do servidor -->
  <meta name="app-key" content="b01c7cd2e87519f8d0e62fafc69c80f8babb54d0a9799fefdad28d4520e7d25bd39f140cb948041e5c5caa43e7d7f905">

  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/pix.css">
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="brand">Bancas</div>
          <div class="subtitle">Depósito via PIX simples, bonito e seguro ✨</div>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <!-- FORMULÁRIO PRINCIPAL -->
      <section class="card" aria-labelledby="form-title">
        <div class="banner">
          <div class="hero-shape" aria-hidden="true"></div>
        </div>
        <div class="card-header">
          <span class="pill">1ª etapa</span>
          <h2 id="form-title" style="margin:12px 0 0">Identificação & Chave PIX</h2>
          <p class="subtitle" style="margin:6px 0 0">Preencha seus dados e escolha a chave PIX para receber o depósito.</p>
        </div>
        <div class="card-body">
          <form id="depositoForm" novalidate>
            <!-- Linha 1: só o Nome -->
            <div class="row">
              <div>
                <label for="nome">Nome completo</label>
                <input class="input" type="text" id="nome" name="nome" placeholder="Seu nome" required>
                <div class="error" id="nomeError">Informe seu nome.</div>
              </div>
            </div>

            <!-- Linha 2: Tipo de chave + Campo dinâmico (CPF OU Chave) -->
            <div class="row" style="margin-top:16px">
              <div>
                <label for="tipoChave">Tipo de chave PIX</label>
                <select class="input" id="tipoChave" name="tipoChave" required>
                  <option value="cpf" selected>CPF</option>
                  <option value="aleatoria">Chave aleatória</option>
                  <option value="telefone">Número de telefone</option>
                  <option value="email">E-mail</option>
                </select>
                <p class="help">Informe a chave conforme o tipo escolhido. Se for CPF, digite o CPF como chave.</p>
              </div>

              <!-- QUANDO tipo = CPF: este aparece -->
              <div id="cpfWrapper">
                <label for="cpf">Informe seu CPF</label>
                <input class="input" type="text" inputmode="numeric" autocomplete="off" id="cpf" name="cpf" placeholder="000.000.000-00" maxlength="14">
                <div class="error" id="cpfError">Informe um CPF válido.</div>
              </div>

              <!-- QUANDO tipo ≠ CPF: este aparece -->
              <div id="chaveWrapper" style="display:none">
                <label for="chavePix">Informe sua chave PIX</label>
                <input class="input" type="text" id="chavePix" name="chavePix" placeholder="Cole aqui sua chave" autocomplete="off">
                <div class="error" id="chaveError">Informe uma chave PIX válida.</div>
              </div>
            </div>

            <div style="margin-top:20px">
              <label for="valor">Valor do depósito</label>
              <input class="input" type="text" id="valor" name="valor" inputmode="decimal" placeholder="R$ 10,00 (mínimo)" required>
              <div class="error" id="valorError">O valor mínimo é R$ 10,00.</div>
            </div>

            <button class="cta" id="btnDepositar" type="submit" style="width:100%">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 5v10m0 0l-3.5-3.5M12 15l3.5-3.5M4 19h16"/></svg>
              Fazer depósito
            </button>
          </form>
        </div>
      </section>

      <!-- RESUMO AO LADO -->
      <aside class="aside">
        <section class="card">
          <div class="card-body">
            <h3 style="margin-top:0">Resumo</h3>
            <ul class="summary-list" id="resumo">
              <!-- CPF removido do resumo -->
              <li><span class="k">Nome</span> <span id="r-nome">—</span></li>
              <li><span class="k">Tipo de chave</span> <span id="r-tipo">CPF</span></li>
              <li id="r-chave-li"><span class="k">Chave</span> <span id="r-chave">—</span></li>
              <li><span class="k">Valor</span> <span id="r-valor">—</span></li>
            </ul>
          </div>
        </section>

        <section class="card">
          <div class="card-body">
            <h3 style="margin-top:0">Como funciona</h3>
            <ol style="margin:0 0 0 18px; color:var(--muted); line-height:1.6">
              <li>Informe seu <strong>nome completo</strong>.</li>
              <li>Escolha o <strong>tipo de chave PIX</strong> (CPF, aleatória, telefone ou e-mail).</li>
              <li>Digite a <strong>chave</strong> conforme o tipo escolhido (se for CPF, digite o CPF).</li>
              <li>Defina o <strong>valor</strong> (mínimo R$ 10,00) e clique em <strong>Fazer depósito</strong>.</li>
            </ol>
          </div>
        </section>
      </aside>
    </div>

    <footer>
      © <span id="ano"></span> Bancas.
    </footer>
  </main>

  <div class="toast" id="toast"></div>

  <!-- Script curtinho só para alternar os campos CPF/Chave sem quebrar seu app.js -->
  <script>
    (function(){
      const ano = document.querySelector('#ano'); if(ano) ano.textContent = new Date().getFullYear();

      const tipo = document.querySelector('#tipoChave');
      const cpfWrap = document.querySelector('#cpfWrapper');
      const chaveWrap = document.querySelector('#chaveWrapper');
      const chaveInput = document.querySelector('#chavePix');
      const cpfInput = document.querySelector('#cpf');
      const rTipo = document.querySelector('#r-tipo');
      const rChave = document.querySelector('#r-chave');

      function maskCPF(v){
        v = String(v||'').replace(/\D/g,'').slice(0,11);
        v = v.replace(/(\d{3})(\d)/,'$1.$2')
             .replace(/(\d{3})(\d)/,'$1.$2')
             .replace(/(\d{3})(\d{1,2})$/,'$1-$2');
        return v;
      }

      function updateUI(){
        const t = tipo.value;
        rTipo.textContent = t === 'aleatoria' ? 'Chave aleatória' : (t.charAt(0).toUpperCase()+t.slice(1));
        if(t === 'cpf'){
          cpfWrap.style.display = '';
          chaveWrap.style.display = 'none';
          // espelha no resumo
          cpfInput.value = maskCPF(cpfInput.value);
          rChave.textContent = cpfInput.value || '—';
        }else{
          cpfWrap.style.display = 'none';
          chaveWrap.style.display = '';
          // placeholder adequado
          chaveInput.placeholder = t === 'telefone' ? '(00) 90000-0000' : (t === 'email' ? 'seu@email.com' : 'Ex.: 2e1a-…)');
          rChave.textContent = (chaveInput.value || '').trim() || '—';
        }
      }

      // máscaras/espelhamento simples
      document.addEventListener('input', (e)=>{
        if(e.target.id === 'cpf'){
          e.target.value = maskCPF(e.target.value);
          if(tipo.value === 'cpf') rChave.textContent = e.target.value || '—';
        }
        if(e.target.id === 'chavePix'){
          if(tipo.value === 'telefone'){
            let v = e.target.value.replace(/\D/g,'').slice(0,11);
            if(v.length > 2) v = `(${v.slice(0,2)}) ${v.slice(2)}`;
            if(v.length > 10) v = `${v.slice(0,10)}-${v.slice(10)}`;
            e.target.value = v;
          }
          if(tipo.value !== 'cpf') rChave.textContent = e.target.value.trim() || '—';
        }
      });

      tipo.addEventListener('change', updateUI);
      updateUI(); // estado inicial
    })();
  </script>

  <!-- Seu fluxo principal do PIX -->
  <script src="assets/js/app.js"></script>
</body>
</html>
